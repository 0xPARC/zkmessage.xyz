// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  publicKey           String    @id
  twitterId           String    @unique
  twitterHandle       String    @unique
  verificationTweetId String    @unique
  group               Message[] @relation("group")
  revealedMessages    Message[] @relation("revealed")
  deniedMessages      Message[] @relation("denied")
}

model Message {
  id                      String  @id @default(uuid())
  group                   User[]  @relation(name: "group")
  msgBody                 String
  serializedProof         String
  serializedPublicSignals String
  msgAttestation          String
  revealedPublicKey       String?
  revealed                User?   @relation(name: "revealed", fields: [revealedPublicKey], references: [publicKey])
  denials                 User[]  @relation(name: "denied")
}
